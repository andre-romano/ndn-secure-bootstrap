rule
{
  id "Simple Rule"
  for data
  filter
  {
    type name
    name /test/prefix
    relation is-prefix-of
  }
  checker
  {
    type customized
    sig-type rsa-sha256
    key-locator
    {
      type name
      regex ^<test><prefix><KEY><>{1,3}$      
    }
  }
}

rule
{
  id "Testbed Hierarchical Validation Rule"
  for data
  checker
  {
    type hierarchical
    sig-type rsa-sha256
  }
}

rule
{
  id "Keys should be signed by trust anchor"
  for data
  filter
  {
    type name
    regex ^([^<KEY>]*)<KEY><>{1,3}$
  }
  checker
  {
    type customized
    sig-type rsa-sha256
    key-locator
    {
      type name      
      regex ^<test><KEY><>{1,3}$
    }
  }
}

trust-anchor
{
  type file
  file-name "scratch/sim_bootsec/config/trustanchor.cert"
}